# 系统级程序设计

## 1第一次课

### 1.1 一些反常的现象

* x*x当发生越界时有可能会小于零
* **1e20+(-1e20+3.14)**=0

### 1.2 内存溢出错误案例

* 当对struct_s的a[2]进行赋值时会影响b的正确值
* 但当对a[4]及以上赋值时不会错误，因为双精度的double占8字节

```c
typedef struct{
    int a[2];
    double b;
} struct_s
```

### 1.3 练习中的各种意想不到的错误

* for循环不能使用 **unsigned** 作为迭代值，当unsigned为0时减1会变最大

* 字符串末尾有 **\0** ，因此字符串的内存占用比 **char c[strlen(str)]** 大

* 在函数体内声明的 **内存指针** 不能作为返回值的内存指针，因为函数结束后会进行回收。

* 进行宏定义容易出现注入问题

  ```C
  #define IS_GREATER(a,b) a>b
  ```

### 1.4 实用写法

```C
p && *p  //可以防止p空指针
a && 5/a  //可以防止除数为零
```

### 1.5 signed和unsigned的最大最小值

|          | 最大值            | 最小值            |
| -------- | ----------------- | ----------------- |
| unsigned | 11111111 11111111 | 00000000 00000000 |
| signed   | 01111111 11111111 | 10000000 0000000  |

### 1.6 转换规则

* signed会隐试转化为unsigned

